sudo: false

language: cpp

branches:
  only:
    - master

addons:
  apt:
    packages: &apt-common
      - cmake

matrix:
  include:
    - env: CCOMPILER=gcc-5 CXXCOMPILER=g++-5 ARCH=-m32
      compiler: gcc
      addons:
        apt:
          sources: &sources-gcc
            - ubuntu-toolchain-r-test
          packages:
            - *apt-common
            - g++-5
            - g++-5-multilib
    - env: CCOMPILER=gcc-5 CXXCOMPILER=g++-5 ARCH=-m64
      compiler: gcc
      addons:
        apt:
          sources: *sources-gcc
          packages:
            - *apt-common
            - g++-5
script:
  - mkdir -p build
  - cd build
  - export CC=${CCOMPILER}
  - export CXX=${CXXCOMPILER}
  - export CFLAGS=${ARCH}
  - export CXXFLAGS=${ARCH}
  - cmake -DCMAKE_BUILD_TYPE=Release ..
  - make

notifications:
  email:
    recipients:
      - mateusz@loskot.net
    on_success: change # [always|never|change] # default: change
    on_failure: always # [always|never|change] # default: always
